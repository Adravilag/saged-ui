---
import ComponentLayout from '../../layouts/ComponentLayout.astro';
import DemoBox from '../../components/DemoBox.astro';
import CodeBlock from '../../components/CodeBlock.astro';
import Playground from '../../components/Playground.astro';

const props = [
  { name: 'open', type: 'boolean', default: 'false', description: 'Si el dropdown está abierto' },
  { name: 'position', type: "'top' | 'bottom'", default: "'bottom'", description: 'Posición vertical del contenido' },
  { name: 'align', type: "'start' | 'center' | 'end'", default: "'start'", description: 'Alineación horizontal' },
  { name: 'disabled', type: 'boolean', default: 'false', description: 'Deshabilita el dropdown' },
  { name: 'close-on-select', type: 'boolean', default: 'true', description: 'Cerrar al seleccionar un item' },
  { name: 'min-width', type: 'string', default: "'200px'", description: 'Ancho mínimo del contenido' },
  { name: 'max-height', type: 'string', default: "'320px'", description: 'Altura máxima (con scroll)' },
  { name: 'show-backdrop', type: 'boolean', default: 'false', description: 'Mostrar overlay de fondo' },
  { name: 'size', type: "'sm' | 'md' | 'lg'", default: "'md'", description: 'Variante de tamaño' },
];

const events = [
  { name: 'sgOpen', type: 'CustomEvent<void>', description: 'Emitido cuando se abre el dropdown' },
  { name: 'sgClose', type: 'CustomEvent<void>', description: 'Emitido cuando se cierra' },
  { name: 'sgToggle', type: 'CustomEvent<boolean>', description: 'Emitido al cambiar el estado' },
];

const slots = [
  { name: 'trigger', description: 'Elemento que activa el dropdown' },
  { name: '(default)', description: 'Contenido del menú' },
  { name: 'header', description: 'Cabecera opcional fija' },
  { name: 'footer', description: 'Pie opcional fijo' },
];

const methods = [
  { name: 'openDropdown', returns: 'Promise<void>', description: 'Abre el dropdown programáticamente' },
  { name: 'closeDropdown', returns: 'Promise<void>', description: 'Cierra el dropdown programáticamente' },
  { name: 'toggle', returns: 'Promise<void>', description: 'Alterna el estado abierto/cerrado' },
];
---

<ComponentLayout
  title="Dropdown"
  tag="sg-dropdown"
  packageName="dropdown"
  description="Menú flotante con elemento trigger. Soporta posicionamiento automático, header/footer fijos, y cierre inteligente."
  props={props}
  events={events}
  slots={slots}
  methods={methods}
>
  <Fragment slot="examples">
    <DemoBox label="Básico" code={`<sg-dropdown align="start">
  <button slot="trigger">Opciones ▼</button>
  <button>Opción 1</button>
  <button>Opción 2</button>
  <button>Opción 3</button>
</sg-dropdown>`}>
      <sg-dropdown align="start">
        <button slot="trigger" class="demo-btn">Opciones ▼</button>
        <button class="demo-menu-item">Opción 1</button>
        <button class="demo-menu-item">Opción 2</button>
        <button class="demo-menu-item">Opción 3</button>
      </sg-dropdown>
    </DemoBox>

    <DemoBox label="Con header y footer" code={`<sg-dropdown align="start">
  <button slot="trigger">Menú ▼</button>
  <div slot="header">Configuración</div>
  <button>Perfil</button>
  <button>Preferencias</button>
  <button>Cerrar sesión</button>
  <div slot="footer">v1.2.1</div>
</sg-dropdown>`}>
      <sg-dropdown align="start">
        <button slot="trigger" class="demo-btn">Menú ▼</button>
        <div slot="header" class="demo-menu-header">Configuración</div>
        <button class="demo-menu-item">Perfil</button>
        <button class="demo-menu-item">Preferencias</button>
        <button class="demo-menu-item">Cerrar sesión</button>
        <div slot="footer" class="demo-menu-footer">v1.2.1</div>
      </sg-dropdown>
    </DemoBox>

    <DemoBox label="Alineaciones" code={`<sg-dropdown align="start">...</sg-dropdown>
<sg-dropdown align="center">...</sg-dropdown>
<sg-dropdown align="end">...</sg-dropdown>`}>
      <div style="display: flex; gap: 1rem; justify-content: center;">
        <sg-dropdown align="start">
          <button slot="trigger" class="demo-btn">Start ▼</button>
          <button class="demo-menu-item">Item 1</button>
          <button class="demo-menu-item">Item 2</button>
        </sg-dropdown>
        <sg-dropdown align="center">
          <button slot="trigger" class="demo-btn">Center ▼</button>
          <button class="demo-menu-item">Item 1</button>
          <button class="demo-menu-item">Item 2</button>
        </sg-dropdown>
        <sg-dropdown align="end">
          <button slot="trigger" class="demo-btn">End ▼</button>
          <button class="demo-menu-item">Item 1</button>
          <button class="demo-menu-item">Item 2</button>
        </sg-dropdown>
      </div>
    </DemoBox>

    <div class="playground-section">
      <h3><sg-icon name="code" size="20"></sg-icon> Playground</h3>
      <p>Edita el código y ve los cambios en tiempo real:</p>
      <Playground 
        code={`<sg-dropdown align="center">
  <button slot="trigger" style="padding: 0.5rem 1rem; background: #6366f1; color: white; border: none; border-radius: 0.375rem; cursor: pointer;">
    Open Menu ▼
  </button>
  <button style="display: block; width: 100%; padding: 0.5rem 1rem; text-align: left; background: none; border: none; color: white; cursor: pointer;">Option 1</button>
  <button style="display: block; width: 100%; padding: 0.5rem 1rem; text-align: left; background: none; border: none; color: white; cursor: pointer;">Option 2</button>
  <button style="display: block; width: 100%; padding: 0.5rem 1rem; text-align: left; background: none; border: none; color: white; cursor: pointer;">Option 3</button>
</sg-dropdown>`}
        height="200px"
      />
    </div>
  </Fragment>

  <Fragment slot="usage">
    <div class="usage-block">
      <h3>Control programático</h3>
      <CodeBlock
        filename="dropdown.js"
        code={`const dropdown = document.querySelector('sg-dropdown');

// Abrir
await dropdown.openDropdown();

// Cerrar
await dropdown.closeDropdown();

// Toggle
await dropdown.toggle();`}
      />
    </div>

    <div class="usage-block">
      <h3>Escuchar eventos</h3>
      <CodeBlock
        filename="events.js"
        code={`dropdown.addEventListener('sgOpen', () => {
  console.log('Dropdown abierto');
});

dropdown.addEventListener('sgClose', () => {
  console.log('Dropdown cerrado');
});`}
      />
    </div>
  </Fragment>
</ComponentLayout>

<style>
  .usage-block {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    padding: 1.5rem;
    box-shadow: var(--shadow-sm);
  }
  .usage-block h3 {
    font-size: 1rem;
    font-weight: 600;
    margin: 0 0 1rem 0;
    color: var(--text);
  }

  .playground-section {
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--border-subtle);
  }
  .playground-section h3 { font-size: 1.125rem; margin-bottom: 0.5rem; }
  .playground-section p { color: var(--text-muted); font-size: 0.875rem; margin-bottom: 1rem; }
</style>
